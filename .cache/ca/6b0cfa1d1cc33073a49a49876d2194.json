{"id":"../node_modules/react-redux-firebase/es/actions/storage.js","dependencies":[{"name":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/node_modules/react-redux-firebase/es/actions/storage.js.map","includedInParent":true,"mtime":1586117796990},{"name":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/package.json","includedInParent":true,"mtime":1586252746660},{"name":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/.babelrc","includedInParent":true,"mtime":1586188670110},{"name":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/node_modules/react-redux-firebase/package.json","includedInParent":true,"mtime":1586117798920},{"name":"lodash/map","loc":{"line":1,"column":201},"parent":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/node_modules/react-redux-firebase/es/actions/storage.js","resolved":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/node_modules/lodash/map.js"},{"name":"../constants","loc":{"line":1,"column":235},"parent":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/node_modules/react-redux-firebase/es/actions/storage.js","resolved":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/node_modules/react-redux-firebase/es/constants.js"},{"name":"../utils/actions","loc":{"line":1,"column":268},"parent":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/node_modules/react-redux-firebase/es/actions/storage.js","resolved":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/node_modules/react-redux-firebase/es/utils/actions.js"},{"name":"../utils/storage","loc":{"line":1,"column":305},"parent":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/node_modules/react-redux-firebase/es/actions/storage.js","resolved":"/Volumes/Baddy-T5/front end/FE-2018/react_js/brad_trvesy/clientpanel-react/node_modules/react-redux-firebase/es/utils/storage.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.uploadFile=uploadFile,exports.uploadFiles=uploadFiles,exports.deleteFile=deleteFile;var _map2=_interopRequireDefault(require(\"lodash/map\")),_constants=require(\"../constants\"),_actions=require(\"../utils/actions\"),_storage=require(\"../utils/storage\");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=_objectWithoutPropertiesLoose(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],!(0<=excluded.indexOf(key))&&Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],0<=excluded.indexOf(key)||(target[key]=source[key]);return target}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null==arguments[i]?{}:arguments[i],i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))});return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var FILE_UPLOAD_START=_constants.actionTypes.FILE_UPLOAD_START,FILE_UPLOAD_ERROR=_constants.actionTypes.FILE_UPLOAD_ERROR,FILE_UPLOAD_COMPLETE=_constants.actionTypes.FILE_UPLOAD_COMPLETE,FILE_DELETE_START=_constants.actionTypes.FILE_DELETE_START,FILE_DELETE_ERROR=_constants.actionTypes.FILE_DELETE_ERROR,FILE_DELETE_COMPLETE=_constants.actionTypes.FILE_DELETE_COMPLETE;function uploadFile(dispatch,firebase,config){if(!firebase.storage)throw new Error(\"Firebase storage is required to upload files\");var _ref=config||{},path=_ref.path,file=_ref.file,dbPath=_ref.dbPath,_ref$options=_ref.options,options=void 0===_ref$options?{progress:!1}:_ref$options,fileMetadata=(options||{}).metadata,logErrors=firebase._.config.logErrors,nameFromOptions=\"function\"==typeof options.name?options.name(file,firebase,config):options.name,filename=nameFromOptions||file.name,meta=_objectSpread({},config,{filename:filename});dispatch({type:FILE_UPLOAD_START,payload:_objectSpread({},config,{filename:filename})});return function uploadPromise(){return options.progress?(0,_storage.uploadFileWithProgress)(dispatch,firebase,{path:path,file:file,filename:filename,meta:meta,fileMetadata:fileMetadata}):firebase.storage().ref(\"\".concat(path,\"/\").concat(filename)).put(file,fileMetadata)}().then(function(uploadTaskSnapshot){return dbPath&&(firebase.database||firebase.firestore)?(0,_storage.writeMetadataToDb)({firebase:firebase,uploadTaskSnapshot:uploadTaskSnapshot,dbPath:dbPath,options:options}).then(function(payload){return dispatch({type:FILE_UPLOAD_COMPLETE,meta:_objectSpread({},config,{filename:filename}),payload:payload}),payload}):(dispatch({type:FILE_UPLOAD_COMPLETE,meta:_objectSpread({},config,{filename:filename}),payload:{uploadTaskSnapshot:uploadTaskSnapshot,uploadTaskSnaphot:uploadTaskSnapshot}}),{uploadTaskSnapshot:uploadTaskSnapshot,uploadTaskSnaphot:uploadTaskSnapshot})}).catch(function(err){return logErrors&&console.error&&console.error(\"RRF: Error uploading file: \".concat(err.message||err),err),dispatch({type:FILE_UPLOAD_ERROR,path:path,payload:err}),Promise.reject(err)})}function uploadFiles(dispatch,firebase,_ref3){var files=_ref3.files,other=_objectWithoutProperties(_ref3,[\"files\"]);return Promise.all((0,_map2.default)(files,function(file){return uploadFile(dispatch,firebase,_objectSpread({file:file},other))}))}function deleteFile(dispatch,firebase,_ref4){var path=_ref4.path,dbPath=_ref4.dbPath;return(0,_actions.wrapInDispatch)(dispatch,{method:_storage.deleteFile,args:[firebase,{path:path,dbPath:dbPath}],types:[FILE_DELETE_START,FILE_DELETE_COMPLETE,FILE_DELETE_ERROR]})}\n"},"sourceMaps":{"js":{"version":3,"sources":["../../src/actions/storage.js"],"names":["FILE_UPLOAD_START","actionTypes","FILE_UPLOAD_ERROR","FILE_UPLOAD_COMPLETE","FILE_DELETE_START","FILE_DELETE_ERROR","FILE_DELETE_COMPLETE","uploadFile","dispatch","firebase","config","storage","Error","path","file","dbPath","options","progress","fileMetadata","metadata","logErrors","_","nameFromOptions","name","filename","meta","type","payload","uploadPromise","ref","put","then","uploadTaskSnapshot","database","firestore","uploadTaskSnaphot","catch","err","console","error","message","Promise","reject","uploadFiles","files","other","all","deleteFile","method","deleteFileFromFb","args","types"],"mappings":"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","sourcesContent":["import { map } from 'lodash'\nimport { actionTypes } from '../constants'\nimport { wrapInDispatch } from '../utils/actions'\nimport {\n  deleteFile as deleteFileFromFb,\n  writeMetadataToDb,\n  uploadFileWithProgress\n} from '../utils/storage'\n\nconst {\n  FILE_UPLOAD_START,\n  FILE_UPLOAD_ERROR,\n  FILE_UPLOAD_COMPLETE,\n  FILE_DELETE_START,\n  FILE_DELETE_ERROR,\n  FILE_DELETE_COMPLETE\n} = actionTypes\n\n/**\n * Upload file to Firebase Storage with option to store\n * file metadata within Firebase Database\n * @param {Function} dispatch - Action dispatch function\n * @param {object} firebase - Internal firebase object\n * @param {object} config - Config object\n * @param {string} config.path - Location within Firebase Stroage at which to upload files.\n * @param {Blob} config.file - File Blob to be uploaded\n * @param {string} config.dbPath - Datbase path to write file meta data to\n * @param {object} config.options - Options\n * @param {string|Function} config.options.name - Name of file. If a function\n * is provided it recieves (fileObject, internalFirebase, config) as arguments.\n * @param {object} config.options.metdata - Metadata for file to be passed along\n * to storage.put calls\n * @returns {Promise} Resolves with meta object\n * @private\n */\nexport function uploadFile(dispatch, firebase, config) {\n  if (!firebase.storage) {\n    throw new Error('Firebase storage is required to upload files')\n  }\n  const { path, file, dbPath, options = { progress: false } } = config || {}\n  const { metadata: fileMetadata } = options || {}\n  const { logErrors } = firebase._.config\n\n  // File renaming through options (supporting string and function)\n  const nameFromOptions =\n    typeof options.name === 'function'\n      ? options.name(file, firebase, config)\n      : options.name\n  const filename = nameFromOptions || file.name\n\n  const meta = { ...config, filename }\n\n  // Dispatch start action\n  dispatch({ type: FILE_UPLOAD_START, payload: { ...config, filename } })\n\n  const uploadPromise = () =>\n    options.progress\n      ? uploadFileWithProgress(dispatch, firebase, {\n          path,\n          file,\n          filename,\n          meta,\n          fileMetadata\n        })\n      : firebase.storage().ref(`${path}/${filename}`).put(file, fileMetadata)\n\n  return uploadPromise()\n    .then((uploadTaskSnapshot) => {\n      if (!dbPath || (!firebase.database && !firebase.firestore)) {\n        dispatch({\n          type: FILE_UPLOAD_COMPLETE,\n          meta: { ...config, filename },\n          payload: {\n            uploadTaskSnapshot,\n            uploadTaskSnaphot: uploadTaskSnapshot // Preserving legacy typo\n          }\n        })\n        return {\n          uploadTaskSnapshot,\n          uploadTaskSnaphot: uploadTaskSnapshot // Preserving legacy typo\n        }\n      }\n\n      // Write File metadata to either Real Time Database or Firestore (depending on config)\n      return writeMetadataToDb({\n        firebase,\n        uploadTaskSnapshot,\n        dbPath,\n        options\n      }).then((payload) => {\n        dispatch({\n          type: FILE_UPLOAD_COMPLETE,\n          meta: { ...config, filename },\n          payload\n        })\n        return payload\n      })\n    })\n    .catch((err) => {\n      if (logErrors) {\n        /* eslint-disable no-console */\n        console.error &&\n          console.error(`RRF: Error uploading file: ${err.message || err}`, err)\n        /* eslint-enable no-console */\n      }\n      dispatch({ type: FILE_UPLOAD_ERROR, path, payload: err })\n      return Promise.reject(err)\n    })\n}\n\n/**\n * Upload multiple files to Firebase Storage with option to store\n * file's metadata within Firebase Database\n * @param {Function} dispatch - Action dispatch function\n * @param {object} firebase - Internal firebase object\n * @param {object} opts - Options object\n * @param {string} opts.path - Storage path to write files to\n * @param {Array} opts.files - List of files to be uploaded\n * @param {string} opts.dbPath - Datbase path to write file meta data to\n * @returns {Promise} Resolves with array of meta objects\n * @private\n */\nexport function uploadFiles(dispatch, firebase, { files, ...other }) {\n  return Promise.all(\n    map(files, (file) => uploadFile(dispatch, firebase, { file, ...other }))\n  )\n}\n\n/**\n * Delete File from Firebase Storage with option to remove meta\n * @param {Function} dispatch - Action dispatch function\n * @param {object} firebase - Internal firebase object\n * @param {object} opts - Options object\n * @param {string} opts.path - Storage path to write files to\n * @param {string} opts.dbPath - Datbase path to write file meta data to\n * @returns {Promise} Resolves with results of deleting a file from storage\n * @private\n */\nexport function deleteFile(dispatch, firebase, { path, dbPath }) {\n  return wrapInDispatch(dispatch, {\n    method: deleteFileFromFb,\n    args: [firebase, { path, dbPath }],\n    types: [FILE_DELETE_START, FILE_DELETE_COMPLETE, FILE_DELETE_ERROR]\n  })\n}\n"],"file":"storage.js"}},"error":null,"hash":"bc65b56b67991848b6c8200f3fe64491","cacheData":{"env":{}}}